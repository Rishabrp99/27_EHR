<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
    integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
    integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
    crossorigin="anonymous"></script>
  <title>User Information</title>
</head>

<body>
  
  <div class="container w-50 mt-2">
    <h2>Basic Information</h2>
  </div>
  <div class="container w-50 mt-3">
    <div class="mb-3">
      <label for="exampleFormControlInput1" class="form-label">Name</label>
      <input type="name" class="form-control" id="name" placeholder="">
    </div>
  </div>
  <div class="container w-50 ">
    <div class="mb-3">
      <label for="exampleFormControlInput1" class="form-label">Emergency Contact</label>
      <input type="number" class="form-control" id="emergency-contact" placeholder="">
    </div>
  </div>
  <div class="container w-50 ">
    <div class="mb-3">
      <label for="exampleFormControlInput1" class="form-label">Phone</label>
      <input type="number" class="form-control" id="phone" placeholder="">
    </div>
  </div>
  <div class="container w-50 ">
    <div class="mb-3">
      <div>Gender</div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="gender" id="inlineRadio1" value="male">
        <label class="form-check-label" for="inlineRadio1">Male</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="gender" id="inlineRadio2" value="female">
        <label class="form-check-label" for="inlineRadio2">Female</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="gender" id="inlineRadio3" value="other">
        <label class="form-check-label" for="inlineRadio3">Other</label>
      </div>
    </div>
  </div>
  <div class="container w-50 ">
    <div class="mb-3">
      <label for="exampleFormControlInput1" class="form-label">address</label>
      <input type="text" class="form-control" id="address" placeholder="">
    </div>
  </div>
  <div class="container w-50 ">
    <div class="mb-3">
      <div>Blood Group</div>
      <select class="form-select form-select-sm" aria-label=".form-select-sm example" id="blood-group">
        <option value="O+" selected>O+</option>
        <option value="A+">A+</option>
        <option value="B+">B+</option>
        <option value="AB+">AB+</option>
        <option value="O-">O-</option>
        <option value="A-">A-</option>
        <option value="B-">B-</option>
        <option value="AB-">AB-</option>
      </select>
    </div>
  </div>
  <div class="container w-50 ">
    <div class="mb-3">
      <label for="exampleFormControlInput1" class="form-label">Age</label>
      <input type="number" class="form-control" id="age" placeholder="">
    </div>
  </div>
  <div class="container w-50 ">
    <div class="mb-3">

      <label for="exampleFormControlInput1" class="form-label">Date of Birth</label>
      <input type="Date" class="form-control" id="dob" placeholder="">
    </div>
  </div>
  <div class="container w-50 ">
    <div class="mb-3">
      <label for="exampleFormControlInput1" class="form-label">Height</label>
      <input type="number" class="form-control" id="height" placeholder="in cms">
    </div>
  </div>
  <div class="container w-50 ">
    <div class="mb-3">
      <label for="exampleFormControlInput1" class="form-label">Weight</label>
      <input type="Number" class="form-control" id="weight" placeholder="in kgs">
    </div>
    <button class="btn btn-primary" id="submit-btn">Submit</button>
  </div>

  <script>
    const submitBtn = document.getElementById("submit-btn");

    const get_field_from_cookie = (field_name) => {

      let res = null;

      let cookie_str = document.cookie;
      let cookie_arr = cookie_str.split(";");

      for (let str of cookie_arr) {

        let key = str.trim().split("=")[0]
        let val = str.trim().split("=")[1]
        if (key == field_name) res = val;
      }
      return res;
    }

    submitBtn.addEventListener("click",  async ()=> {
      
      console.log("Hello1")
      id = get_field_from_cookie(field_name = "user_id");
      name = document.getElementById("name").value;
      emergency_contact = document.getElementById("emergency-contact").value;
      phone = document.getElementById("phone").value;
      gender = document.querySelector('input[name="gender"]:checked').value;
      address = document.getElementById("address").value;
      blood_group = document.getElementById("blood-group").value;
      age = document.getElementById("age").value;
      dob = document.getElementById("dob").value;
      height = document.getElementById("height").value;
      weight = document.getElementById("weight").value;

      let data = {
        id: id,
        name: name,
        emergency_contact: emergency_contact,
        phone: phone,
        gender: gender,
        address: address,
        blood_group: blood_group,
        age: age,
        height: height,
        weight: weight
      }
      console.log(data);
      const res = await fetch("/api/patient", {
        method: 'POST', // *GET, POST, PUT, DELETE, etc.
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(data) // body data type must match "Content-Type" header
      }); // parses JSON response into native JavaScript objects

      let response = await res.json();
      console.log(response)
      if (response.status === "success") {
        window.location.href = "/login"
      }
    })
  </script>
</body>

</html>